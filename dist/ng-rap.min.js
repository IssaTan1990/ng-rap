angular.module("ngRap",[]).provider("ngRap",[function(){var a=this;this.enable=function(a){this.enabled=!0,this.mode=a.mode},this.$get=["$injector","$q",function(b,c){function d(){var b=c.defer(),d=document.createElement("script");return d.src=a.script,d.onload=d.onreadystatechange=function(a,c){(c||!d.readyState||/loaded|complete/.test(d.readyState))&&(d.onload=d.onreadystatechange=null,d=void 0,c||b.resolve())},document.body.appendChild(d),b.promise}var e={check:function(a,c){var d=b.get("$http");d.get(a).success(function(a){RAP.checkerHandler.call({data:c},a)})},intercept:function(a){{var c=RAP.getMode(),d=RAP.getWhiteList(),e=RAP.getBlackList(),f=a.url,g="http://"+RAP.getHost()+"/mockjsdata/"+RAP.getProjectId(),h=g+f;b.get("$http")}return-1!=a.url.indexOf(g)?a:0==c?(-1!=d.indexOf(f)&&(a.needCheck=h),a):1==c?(a.mocked=!0,a.url=h,a):2==c?(-1==e.indexOf(f)&&(a.mocked=!0,a.url=h),a):3==c?(-1!=d.indexOf(f)&&(a.mocked=!0,a.url=h),a):void 0},loaded:a.enabled&&d().then(function(){window.RAP&&RAP.setMode(a.mode)})};return e}]}]).factory("rapMockInterceptor",["$q","ngRap",function(a,b){return{request:function(a){return b.loaded?b.loaded.then(function(){return b.intercept(a)}):a},response:function(a){var c=a.data;return b.loaded&&!a.config.mocked&&b.loaded.then(function(){a.config.needCheck&&b.check(a.config.needCheck,c)}),a}}}]);